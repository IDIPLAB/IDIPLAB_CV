

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples: Basics &mdash; wechat-python-sdk 0.5.9 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> wechat-python-sdk
          

          
          </a>

          
            
            
              <div class="version">
                0.5.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">快速开始</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">数据预处理</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">数据预处理</a></li>
</ul>
<p class="caption"><span class="caption-text">大好山河</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/examples_basics.html">Examples: Basics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">wechat-python-sdk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Examples: Basics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/preprocessing/examples_basics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples-basics">
<h1>Examples: Basics<a class="headerlink" href="#examples-basics" title="Permalink to this headline">¶</a></h1>
<div class="section" id="a-standard-use-case">
<h2>A standard use case<a class="headerlink" href="#a-standard-use-case" title="Permalink to this headline">¶</a></h2>
<p>The following example shows a standard use case.
An augmentation sequence (crop + horizontal flips + gaussian blur) is defined
once at the start of the script. Then many batches are loaded and augmented
before being used for training.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">imgaug</span> <span class="k">import</span> <span class="n">augmenters</span> <span class="k">as</span> <span class="n">iaa</span>

<span class="n">seq</span> <span class="o">=</span> <span class="n">iaa</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">px</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">)),</span> <span class="c1"># crop images from each side by 0 to 16px (randomly chosen)</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Fliplr</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="c1"># horizontally flip 50% of the images</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span> <span class="c1"># blur images with a sigma of 0 to 3.0</span>
<span class="p">])</span>

<span class="k">for</span> <span class="n">batch_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="c1"># &#39;images&#39; should be either a 4D numpy array of shape (N, height, width, channels)</span>
    <span class="c1"># or a list of 3D numpy arrays, each having shape (height, width, channels).</span>
    <span class="c1"># Grayscale images must have shape (height, width, 1) each.</span>
    <span class="c1"># All images must have numpy&#39;s dtype uint8. Values are expected to be in</span>
    <span class="c1"># range 0-255.</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">load_batch</span><span class="p">(</span><span class="n">batch_idx</span><span class="p">)</span>
    <span class="n">images_aug</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">augment_images</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
    <span class="n">train_on_images</span><span class="p">(</span><span class="n">images_aug</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="a-simple-and-common-augmentation-sequence">
<h2>A simple and common augmentation sequence<a class="headerlink" href="#a-simple-and-common-augmentation-sequence" title="Permalink to this headline">¶</a></h2>
<p>The following example shows an augmentation sequence that might be useful
for many common experiments. It applies crops and affine transformations
to images, flips some of the images horizontally, adds a bit of noise and blur
and also changes the contrast as well as brightness.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">imgaug</span> <span class="k">as</span> <span class="nn">ia</span>
<span class="kn">from</span> <span class="nn">imgaug</span> <span class="k">import</span> <span class="n">augmenters</span> <span class="k">as</span> <span class="n">iaa</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ia</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Example batch of images.</span>
<span class="c1"># The array has shape (32, 64, 64, 3) and dtype uint8.</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">ia</span><span class="o">.</span><span class="n">quokka</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="p">)</span>

<span class="n">seq</span> <span class="o">=</span> <span class="n">iaa</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Fliplr</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="c1"># horizontal flips</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">percent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)),</span> <span class="c1"># random crops</span>
    <span class="c1"># Small gaussian blur with random sigma between 0 and 0.5.</span>
    <span class="c1"># But we only blur about 50% of all images.</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Sometimes</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">iaa</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="p">),</span>
    <span class="c1"># Strengthen or weaken the contrast in each image.</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">ContrastNormalization</span><span class="p">((</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)),</span>
    <span class="c1"># Add gaussian noise.</span>
    <span class="c1"># For 50% of all images, we sample the noise once per pixel.</span>
    <span class="c1"># For the other 50% of all images, we sample the noise per pixel AND</span>
    <span class="c1"># channel. This can change the color (not only brightness) of the</span>
    <span class="c1"># pixels.</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">AdditiveGaussianNoise</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="c1"># Make some images brighter and some darker.</span>
    <span class="c1"># In 20% of all cases, we sample the multiplier once per channel,</span>
    <span class="c1"># which can end up changing the color of the images.</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Multiply</span><span class="p">((</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
    <span class="c1"># Apply affine transformations to each image.</span>
    <span class="c1"># Scale/zoom them, translate/move them, rotate them and shear them.</span>
    <span class="n">iaa</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span>
        <span class="n">scale</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)},</span>
        <span class="n">translate_percent</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)},</span>
        <span class="n">rotate</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span>
        <span class="n">shear</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">],</span> <span class="n">random_order</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># apply augmenters in random order</span>

<span class="n">images_aug</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">augment_images</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure" id="id1">
<img alt="Simple augmentations" src="../_images/simple.jpg" />
<p class="caption"><span class="caption-text">Example results of the above simple augmentation sequence.</span></p>
</div>
</div>
<div class="section" id="heavy-augmentations">
<h2>Heavy Augmentations<a class="headerlink" href="#heavy-augmentations" title="Permalink to this headline">¶</a></h2>
<p>The following example shows a large augmentation sequence containing many
different augmenters, leading to  significant changes in the augmented images.
Depending on the use case, the sequence might be too strong. Occasionally
it can also break images by changing them too much. To weaken the effects
you can lower the value of <code class="docutils literal"><span class="pre">iaa.SomeOf((0,</span> <span class="pre">5),</span> <span class="pre">...)</span></code> to e.g. <code class="docutils literal"><span class="pre">(0,</span> <span class="pre">3)</span></code>
or decrease the probability of some augmenters to be applied by decreasing in
<code class="docutils literal"><span class="pre">sometimes</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">aug:</span> <span class="pre">iaa.Sometimes(0.5,</span> <span class="pre">aug)</span></code> the value <code class="docutils literal"><span class="pre">0.5</span></code> to e.g.
<code class="docutils literal"><span class="pre">0.3</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">imgaug</span> <span class="k">as</span> <span class="nn">ia</span>
<span class="kn">from</span> <span class="nn">imgaug</span> <span class="k">import</span> <span class="n">augmenters</span> <span class="k">as</span> <span class="n">iaa</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">ia</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Example batch of images.</span>
<span class="c1"># The array has shape (32, 64, 64, 3) and dtype uint8.</span>
<span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">ia</span><span class="o">.</span><span class="n">quokka</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span>
<span class="p">)</span>

<span class="c1"># Sometimes(0.5, ...) applies the given augmenter in 50% of all cases,</span>
<span class="c1"># e.g. Sometimes(0.5, GaussianBlur(0.3)) would blur roughly every second</span>
<span class="c1"># image.</span>
<span class="n">sometimes</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">aug</span><span class="p">:</span> <span class="n">iaa</span><span class="o">.</span><span class="n">Sometimes</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">aug</span><span class="p">)</span>

<span class="c1"># Define our sequence of augmentation steps that will be applied to every image.</span>
<span class="n">seq</span> <span class="o">=</span> <span class="n">iaa</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="c1">#</span>
        <span class="c1"># Apply the following augmenters to most images.</span>
        <span class="c1">#</span>
        <span class="n">iaa</span><span class="o">.</span><span class="n">Fliplr</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="c1"># horizontally flip 50% of all images</span>
        <span class="n">iaa</span><span class="o">.</span><span class="n">Flipud</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span> <span class="c1"># vertically flip 20% of all images</span>

        <span class="c1"># crop some of the images by 0-10% of their height/width</span>
        <span class="n">sometimes</span><span class="p">(</span><span class="n">iaa</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">percent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))),</span>

        <span class="c1"># Apply affine transformations to some of the images</span>
        <span class="c1"># - scale to 80-120% of image height/width (each axis independently)</span>
        <span class="c1"># - translate by -20 to +20 relative to height/width (per axis)</span>
        <span class="c1"># - rotate by -45 to +45 degrees</span>
        <span class="c1"># - shear by -16 to +16 degrees</span>
        <span class="c1"># - order: use nearest neighbour or bilinear interpolation (fast)</span>
        <span class="c1"># - mode: use any available mode to fill newly created pixels</span>
        <span class="c1">#         see API or scikit-image for which modes are available</span>
        <span class="c1"># - cval: if the mode is constant, then use a random brightness</span>
        <span class="c1">#         for the newly created pixels (e.g. sometimes black,</span>
        <span class="c1">#         sometimes white)</span>
        <span class="n">sometimes</span><span class="p">(</span><span class="n">iaa</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span>
            <span class="n">scale</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)},</span>
            <span class="n">translate_percent</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)},</span>
            <span class="n">rotate</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
            <span class="n">shear</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
            <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">cval</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">ia</span><span class="o">.</span><span class="n">ALL</span>
        <span class="p">)),</span>

        <span class="c1">#</span>
        <span class="c1"># Execute 0 to 5 of the following (less important) augmenters per</span>
        <span class="c1"># image. Don&#39;t execute all of them, as that would often be way too</span>
        <span class="c1"># strong.</span>
        <span class="c1">#</span>
        <span class="n">iaa</span><span class="o">.</span><span class="n">SomeOf</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
            <span class="p">[</span>
                <span class="c1"># Convert some images into their superpixel representation,</span>
                <span class="c1"># sample between 20 and 200 superpixels per image, but do</span>
                <span class="c1"># not replace all superpixels with their average, only</span>
                <span class="c1"># some of them (p_replace).</span>
                <span class="n">sometimes</span><span class="p">(</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">Superpixels</span><span class="p">(</span>
                        <span class="n">p_replace</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
                        <span class="n">n_segments</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">),</span>

                <span class="c1"># Blur each image with varying strength using</span>
                <span class="c1"># gaussian blur (sigma between 0 and 3.0),</span>
                <span class="c1"># average/uniform blur (kernel size between 2x2 and 7x7)</span>
                <span class="c1"># median blur (kernel size between 3x3 and 11x11).</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">OneOf</span><span class="p">([</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)),</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">AverageBlur</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)),</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">MedianBlur</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)),</span>
                <span class="p">]),</span>

                <span class="c1"># Sharpen each image, overlay the result with the original</span>
                <span class="c1"># image using an alpha between 0 (no sharpening) and 1</span>
                <span class="c1"># (full sharpening effect).</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">Sharpen</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">lightness</span><span class="o">=</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)),</span>

                <span class="c1"># Same as sharpen, but for an embossing effect.</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">Emboss</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">strength</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)),</span>

                <span class="c1"># Search in some images either for all edges or for</span>
                <span class="c1"># directed edges. These edges are then marked in a black</span>
                <span class="c1"># and white image and overlayed with the original image</span>
                <span class="c1"># using an alpha of 0 to 0.7.</span>
                <span class="n">sometimes</span><span class="p">(</span><span class="n">iaa</span><span class="o">.</span><span class="n">OneOf</span><span class="p">([</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">EdgeDetect</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)),</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">DirectedEdgeDetect</span><span class="p">(</span>
                        <span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                    <span class="p">),</span>
                <span class="p">])),</span>

                <span class="c1"># Add gaussian noise to some images.</span>
                <span class="c1"># In 50% of these cases, the noise is randomly sampled per</span>
                <span class="c1"># channel and pixel.</span>
                <span class="c1"># In the other 50% of all cases it is sampled once per</span>
                <span class="c1"># pixel (i.e. brightness change).</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">AdditiveGaussianNoise</span><span class="p">(</span>
                    <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.5</span>
                <span class="p">),</span>

                <span class="c1"># Either drop randomly 1 to 10% of all pixels (i.e. set</span>
                <span class="c1"># them to black) or drop them on an image with 2-5% percent</span>
                <span class="c1"># of the original size, leading to large dropped</span>
                <span class="c1"># rectangles.</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">OneOf</span><span class="p">([</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">Dropout</span><span class="p">((</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">CoarseDropout</span><span class="p">(</span>
                        <span class="p">(</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">),</span> <span class="n">size_percent</span><span class="o">=</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
                        <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.2</span>
                    <span class="p">),</span>
                <span class="p">]),</span>

                <span class="c1"># Invert each image&#39;s chanell with 5% probability.</span>
                <span class="c1"># This sets each pixel value v to 255-v.</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">Invert</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">per_channel</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="c1"># invert color channels</span>

                <span class="c1"># Add a value of -10 to 10 to each pixel.</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>

                <span class="c1"># Change brightness of images (50-150% of original value).</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">Multiply</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>

                <span class="c1"># Improve or worsen the contrast of images.</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">ContrastNormalization</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span> <span class="n">per_channel</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>

                <span class="c1"># Convert each image to grayscale and then overlay the</span>
                <span class="c1"># result with the original with random alpha. I.e. remove</span>
                <span class="c1"># colors with varying strengths.</span>
                <span class="n">iaa</span><span class="o">.</span><span class="n">Grayscale</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>

                <span class="c1"># In some images move pixels locally around (with random</span>
                <span class="c1"># strengths).</span>
                <span class="n">sometimes</span><span class="p">(</span>
                    <span class="n">iaa</span><span class="o">.</span><span class="n">ElasticTransformation</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
                <span class="p">),</span>

                <span class="c1"># In some images distort local areas with varying strength.</span>
                <span class="n">sometimes</span><span class="p">(</span><span class="n">iaa</span><span class="o">.</span><span class="n">PiecewiseAffine</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)))</span>
            <span class="p">],</span>
            <span class="c1"># do all of the above augmentations in random order</span>
            <span class="n">random_order</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="c1"># do all of the above augmentations in random order</span>
    <span class="n">random_order</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">images_aug</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">augment_images</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure" id="id2">
<img alt="Heavy augmentations" src="../_images/heavy.jpg" />
<p class="caption"><span class="caption-text">Example results of the above heavy augmentation sequence.</span></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Ace Kwok.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.5.9',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>